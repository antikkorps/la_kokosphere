<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Decap CMS Simple</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  </head>
  <body>
    <div
      id="login-section"
      style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: white;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      "
    >
      <div style="text-align: center">
        <h2>Connexion requise</h2>
        <button
          onclick="netlifyIdentity.open()"
          style="
            background: #007cba;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
          "
        >
          Se connecter
        </button>
      </div>
    </div>

    <div id="cms-root" style="display: none"></div>

    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

    <script>
      netlifyIdentity.init()

      if (netlifyIdentity.currentUser()) {
        showCMS()
      }

      netlifyIdentity.on("login", () => {
        showCMS()
      })

      netlifyIdentity.on("logout", () => {
        hideCMS()
      })

      function showCMS() {
        document.getElementById("login-section").style.display = "none"
        document.getElementById("cms-root").style.display = "block"
      }

      function hideCMS() {
        document.getElementById("login-section").style.display = "flex"
        document.getElementById("cms-root").style.display = "none"
      }
    </script>
  </body>
</html>
